<div class="posts" id="pinned_posts_board">
    {% if pinneds %}
    {% if pinneds | length > 0 %}
    {% for pinned in pinneds %}
    <div class="divisoria"></div>
    <div class="post" id="{{ pinned.post_id }}">
        <div class="postInfo">
            <input type="checkbox" class="deletionCheckBox" name="65004" form="banDeleteForm">
            <span class="nameBlock"><span class="name">{% if pinned.post_user == '' or pinned.post_user == 'Anonymous' %}ãƒ‰ãƒ¯ãƒ¼ãƒ•{% else %}{{ pinned.post_user | safe }}{% endif %}</span></span>
            <span class="postDate">{{ pinned.post_date }}</span><a href="/{{ board_id }}/thread/{{ pinned.post_id }}" class="postLink">No. </a> <a class="postLink" href="/{{ board_id }}/thread/{{ pinned.post_id }}" class="postNumber">{{ pinned.post_id }}</a>
                <a class="postLink" href="/{{ board_id }}/thread/{{ pinned.post_id }}"> [{{ lang['thread-reply-button'] }}]</a>
        </div>
        <div class="post_content_container">
            <div class="post_image">
                <div class="post_image_info">
                    <a class="image_url" href="/static/post_images/{{ pinned.get('post_image') }}">{{ pinned.get('post_image')[:17] + '.' + pinned.get('post_image').split('.')[-1] }}</a>
                </div>
                {% if '.mp4' in pinned.post_image or '.mov' in pinned.post_image or '.webm' in pinned.post_image  %}
                <video controls draggable="false" class="post_video" src="{{ url_for('static', filename='/post_images/' + pinned.post_image) }}" alt="">
                {% endif %}
                <img draggable="false" class="post_img" src="{{ url_for('static', filename='/post_images/' + pinned.post_image) }}" alt="">
            </div>
            <div class="post_content">
                <pre>{% if pinned.post_content | length >= 500 %}{{ pinned.post_content[:450] | safe }}...<a class="toolong" href="/{{ board_id }}/thread/{{ pinned.post_id }}">Ver mais.</a>{% else %}{{ pinned.post_content | safe }}{% endif %}</pre>
            </div>
            <div class="replies">
                {% set post_replies = replies|selectattr('post_id', 'equalto', pinned.post_id)|list %}
                {% set last_4_replies = post_replies[-4:] %}
                {% set hidden_replies_count = post_replies|length - 4 if post_replies|length > 4 else 0 %}

                {% for reply in last_4_replies %}
                <div class="reply" id="{{ reply.reply_id }}">
                    <div class="reply-postInfo">
                        <input type="checkbox" class="deletionCheckBox" name="{{ pinned.post_id }}" form="banDeleteForm">
                        <span class="nameBlock"><span class="name">{% if not reply.post_user or reply.post_user == '' %}ãƒ‰ãƒ¯ãƒ¼ãƒ•{% else %}{{ reply.post_user | safe }}{% endif %}</span></span>
                        <span class="postDate">{{ reply.post_date }}</span><a href="/{{ board_id }}/thread/{{ pinned.post_id }}" class="postLink">No. </a> <a class="postLink" href="/{{ board_id }}/thread/{{ pinned.post_id }}" >{{ reply.reply_id }}</a>
                    </div>
                    <div class="post_content_container">
                        {% if reply.image != '' %}
                        <div class="reply_image">
                            <div class="reply_image_info">
                                <a class="image_url" href="/static/reply_images/{{ reply.get('image') }}">{{ reply.get('image')[:17] + '.' + reply.get('image').split('.')[-1] }}</a>
                            </div>
                            {% if '.mp4' in reply.image %}
                            <video controls draggable="false" class="reply_img" src="{{ url_for('static', filename='/reply_images/' + reply.image) }}" alt="">
                            {% endif %}
                            <img draggable="false" class="reply_img" src="{{ url_for('static', filename='/reply_images/' + reply.image) }}" alt="">
                        </div>
                        {% endif %}
                        <div class="reply_content">
                            <pre>{{ reply.content | safe }}</pre>
                        </div>
                    </div>
                </div>
                {% endfor %}
                {% if hidden_replies_count > 0 %}
                <div class="hidden-replies">
                    <span>{{ hidden_replies_count }} {{ lang['hidden-replies'] }}</span>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
    {% endif %}
    {% endif %}
</div>
                                                                                          
â”Œâ”€â”€(rootðŸ’€lsd-SubjectPunch)-[/var/â€¦/html/rchan/templates/utils]
â””â”€# cat threadform.html  
<div id="togglePostFormLink" bis_skin_checked="1"><a href="#draggableForm">{% if post_mode == 'reply' %}[NEW REPLY]{% else %}[{{
        lang["thread-form-button"] }}]{% endif %}</a></div>

<div class="newboard-form" id="draggableForm">
    <form id="postform" action="/new_post" enctype="multipart/form-data" method="POST">
        <input type="hidden" name="board_id" value="{{ board_id }}">
        <input type="hidden" name="thread_id" value="{{ thread_id }}">
        <input type="hidden" name="post_mode" value="{{ post_mode }}">

        <div class="new-thread-container">
            <div class="new-thread-header">
                <h1>{% if post_mode == 'reply' %}New Reply{% else %}{{ lang["thread-form-button"] }}{% endif %}</h1>
            </div>
            <section class="row">
                <div class="label" bis_skin_checked="1">Name</div><input class="mr-1" type="text" name="name"
                    placeholder="Anon" maxlength="100"><a class="close postform-style" href="#!"
                    bis_skin_checked="1">Ã—</a>
            </section>
            <section class="row">
                <div class="label" bis_skin_checked="1"><span>Subject</span></div><input type="text" name="subject"
                    autocomplete="off" maxlength="100">
            </section>
            <section class="row">
                <div class="label" bis_skin_checked="1"><span>Message</span><small>(0/20000)</small></div><textarea
                    id="text" name="text" rows="5" minlength="0" maxlength="10000"></textarea>
            </section>
            <section class="row">
                <div class="label" bis_skin_checked="1"><span>Files<span class="required">*</span></span>
                    <small>Max 5 files</small><small>10MB total</small>
                </div><span class="col"><label class="jsonly postform-style filelabel" for="file"> Select/Drop/Paste
                        files</label><input id="file" type="file" name="fileInput" multiple=""
                        style="position: absolute; border: none; height: 1px; width: 1px;">
                    <div class="upload-list" data-spoilers="true" data-strip-filenames="true" bis_skin_checked="1">
                    </div>
                </span>
            </section>
            <section class="row">
                <div class="label" bis_skin_checked="1"><span>Embed</span></div><input type="text" name="embed"
                    autocomplete="off" maxlength="100">
            </section>
            {% if board_info.enable_captcha %}
            {% if board_info.enable_captcha == 1%}
            <div class="row" bis_skin_checked="1">
                <div class="label" bis_skin_checked="1">captcha</div>
                <img style="width: 100%;" src="{{ captcha_image }}" alt="">
            </div>
            <div class="row" bis_skin_checked="1">
                <div class="label" bis_skin_checked="1">captcha</div>
                <input type="text" name="captcha" maxlength="100">
            </div>
            {% endif %}
            {% endif %}
            <input id="submitpost" type="submit" value="{{ lang['thread-form-button'] }}">
        </div>
    </form>
</div>
